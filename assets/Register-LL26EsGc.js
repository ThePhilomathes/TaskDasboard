import{e as y,n as A,c as m,a as s,i as a,v as i,A as D,B as T,b,E as h,F as V,r as F,h as d,y as p,C as I,z as M,o as g,t as R}from"./index-E67r8Q8L.js";import{c as E,e as L}from"./default-CrXRTFLY.js";const v="users",x={fname:"First Name",lname:"Last Name",username:"Username",password:"Password",birthday:"Birth Day",AccountTypeID:"Account Type ID"},S=async(o=null)=>{if(o==null)throw new Error("Missing Username to be Checked");let t=!0;return(await y.from(v).select("id").eq("username",o)).data.length==0&&(t=!1),t},q=async(o=null)=>{if(o===null)throw new Error("Missing Data to be Checked");const t=E(o,x),l=o.username??null;return l&&t.length==0&&await S(l)&&t.push("Username is already registered"),t},C=async(o=null)=>{if(o===null)throw new Error("Missing Data to be Saved");const t={...L(o,x)};return(await y.from(v).insert([t])).error?null:1},N=async(o="AccountTypes")=>(await y.from(o).select("AccountTypeID, Description").eq("Status",!0).neq("AccountTypeID",1)).data??[],j={class:"min-h-screen flex items-center justify-center bg-slate-100"},B={class:"w-full max-w-md bg-white rounded-xl shadow-lg p-8"},P={class:"space-y-4"},O={class:"grid grid-cols-2 gap-4"},z=["type"],K={class:"flex items-center gap-2 text-sm"},$=["value"],J={__name:"Register",setup(o){const t=d({fname:"",lname:"",username:"",password:"",birthday:""}),l=d({AccountTypes:[]}),u=d(!1),c=d(!1),f=()=>{M.push({name:"Login"})},w=()=>{for(const r of Object.keys(t.value))t.value[r]=null},k=async()=>{if(u.value!=!0){u.value=!0;try{const r=await q(t.value);if(r.length>0){p(r[0]);return}if(!await C(t.value)){p("Failed to Register");return}I(`Successfully Registered ${t.value.username}`),w(),setTimeout(()=>{f()},2e3)}catch(r){console.error(r);const e=r?.message;p(e)}finally{u.value=!1}}},U=async()=>{l.value.AccountTypes=await N("AccountTypes")};return A(async()=>{U()}),(r,e)=>(g(),m("div",j,[s("div",B,[e[15]||(e[15]=s("h1",{class:"text-2xl font-semibold text-gray-800 mb-2"},"Create account",-1)),e[16]||(e[16]=s("p",{class:"text-sm text-gray-500 mb-6"},"Fill in your details",-1)),s("div",P,[s("div",O,[s("div",null,[e[7]||(e[7]=s("label",{class:"block text-sm font-medium text-gray-600 mb-1"}," First name ",-1)),a(s("input",{"onUpdate:modelValue":e[0]||(e[0]=n=>t.value.fname=n),type:"text",class:"w-full rounded-lg border border-gray-300 px-4 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500"},null,512),[[i,t.value.fname]])]),s("div",null,[e[8]||(e[8]=s("label",{class:"block text-sm font-medium text-gray-600 mb-1"}," Last name ",-1)),a(s("input",{"onUpdate:modelValue":e[1]||(e[1]=n=>t.value.lname=n),type:"text",class:"w-full rounded-lg border border-gray-300 px-4 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500"},null,512),[[i,t.value.lname]])])]),s("div",null,[e[9]||(e[9]=s("label",{class:"block text-sm font-medium text-gray-600 mb-1"}," Birthday ",-1)),a(s("input",{"onUpdate:modelValue":e[2]||(e[2]=n=>t.value.birthday=n),type:"date",class:"w-full rounded-lg border border-gray-300 px-4 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500"},null,512),[[i,t.value.birthday]])]),s("div",null,[e[10]||(e[10]=s("label",{class:"block text-sm font-medium text-gray-600 mb-1"}," Username ",-1)),a(s("input",{"onUpdate:modelValue":e[3]||(e[3]=n=>t.value.username=n),type:"text",class:"w-full rounded-lg border border-gray-300 px-4 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500"},null,512),[[i,t.value.username]])]),s("div",null,[e[11]||(e[11]=s("label",{class:"block text-sm font-medium text-gray-600 mb-1"}," Password ",-1)),a(s("input",{type:c.value?"text":"password","onUpdate:modelValue":e[4]||(e[4]=n=>t.value.password=n),class:"w-full rounded-lg border border-gray-300 px-4 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500"},null,8,z),[[D,t.value.password]])]),s("label",K,[a(s("input",{type:"checkbox","onUpdate:modelValue":e[5]||(e[5]=n=>c.value=n)},null,512),[[T,c.value]]),e[12]||(e[12]=b(" Show password ",-1))]),s("div",null,[e[13]||(e[13]=s("label",{class:"block text-sm font-medium text-gray-600 mb-1"}," AccountType ",-1)),a(s("select",{"onUpdate:modelValue":e[6]||(e[6]=n=>t.value.AccountTypeID=n),class:"block w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-sm focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500 disabled:bg-gray-100 disabled:text-gray-400"},[(g(!0),m(V,null,F(l.value.AccountTypes,n=>(g(),m("option",{value:n.AccountTypeID},R(n.Description),9,$))),256))],512),[[h,t.value.AccountTypeID]])]),s("button",{onClick:k,class:"w-full bg-indigo-600 hover:bg-indigo-700 text-white py-2 rounded-lg font-medium transition"}," Register ")]),s("p",{class:"text-center text-sm text-gray-500 mt-6"},[e[14]||(e[14]=b(" Already have an account? ",-1)),s("a",{onClick:f,class:"text-indigo-600 hover:underline"},"Login")])])]))}};export{J as default};
